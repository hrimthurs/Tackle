/* @hrimthurs/tackle 1.31.2 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Tackle={})}(this,(function(e){"use strict";function t(e,t=0){const n={f1:3735928559,f2:2654435761,f3:2246822507},r={f1:1103547991,f2:1597334677,f3:3266489909};let o=n.f1^t,s=r.f1^t;for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);o=Math.imul(o^a,n.f2),s=Math.imul(s^a,r.f2)}o=Math.imul(o^o>>>16,n.f3)^Math.imul(s^s>>>13,r.f3),s=Math.imul(s^s>>>16,n.f3)^Math.imul(o^o>>>13,r.f3);let a=(s>>>0).toString(16)+(o>>>0).toString(16);return"0".repeat(16-a.length)+a}var n={formatNumber:function(e,t,n=0){const r=Math.abs(e),o=e<0?"-":"",s=n?r.toFixed(n):r.toString();let a=t-s.length-o.length;return o+(a<=0?s:Number.isInteger(e)&&!n?"0".repeat(a)+s:s+"0".repeat(a))},getHash:t};function r(e,t,n=!1){let r=u(e,{number:e=>Number(e.toFixed(t))});return n?r:JSON.parse(r)}function o(e=1,t=null){const n=2147483647,r=1e5,o=t?.min?t.min-1:0,s=(t?.max??r)-o+1;let a=e%n;return function(e=null){if(a=48271*a%n,e){const t=e.min?e.min-1:0,n=(e.max??r)-t+1;return Math.trunc(a%n+t)}{const e=a%s+o;return t?Math.trunc(e):e/r}}}function s(e,t={},n=!1){let r="string"==typeof e?l(e):e;if(r)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>u(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${u(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):u(o)}r.searchParams.set(e,n?encodeURIComponent(o):o)}}return r}var a={bytesToKb:function(e,t=2){return r(e/1024,t)},bytesToMb:function(e,t=2){return r(e/1048576,t)},arrayBufferToBlob:function(e){return new Blob([e],{type:"application/octet-stream"})},arrayBufferToString:function(e){return btoa(new Uint8Array(e).reduce(((e,t)=>e+String.fromCharCode(t)),""))},trimFloat:r,randomLCG:o,getParamsURL:function(e=null,t={}){const n={keysLowerCase:!1,valsLowerCase:!1,...t};let r={},o=e instanceof URL?e:l(e);if(o)for(const e of o.searchParams.keys()){let t=o.searchParams.get(e).replace(/^["'](.*)["']$/,"$1"),s=c(n.valsLowerCase?t.toLowerCase():t),a=s.reduce(((e,t)=>{if("string"==typeof t){let n=t.split(":"),[r,...o]=n,s=o.length>1?o.join(":"):o[0];void 0!==s&&(e[r]=f(s))}return e}),{}),i=Object.keys(a).length!=s.length?s.length>1?s:s[0]:a;r[n.keysLowerCase?e.toLowerCase():e]=i}return r},setParamsURL:s,generateHashUID:function(e=""){const n=10+Math.trunc(10*Math.random()),r=new Array(n).fill(0).map((()=>Math.random())).join();return t(e+Date.now()+r,Math.random())},generateUID:function(e,t){return e>1784e9&&1e5*t||1e8},generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(i[255&e]+i[e>>8&255]+i[e>>16&255]+i[e>>24&255]+"-"+i[255&t]+i[t>>8&255]+"-"+i[t>>16&15|64]+i[t>>24&255]+"-"+i[63&n|128]+i[n>>8&255]+"-"+i[n>>16&255]+i[n>>24&255]+i[255&r]+i[r>>8&255]+i[r>>16&255]+i[r>>24&255]).toLowerCase()},promiseTimeout:function(e,t={}){return new Promise((async(n,r)=>{const o=setTimeout((()=>{t.timeoutReject?r(new Error("timeout")):n()}),e);if(t?.cbCreate(n,o),t.func)try{n(await t.func(...t.args??[]))}catch(e){r(e)}finally{clearTimeout(o)}}))}};const i=new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));function c(e){let t=[],n=[],r=0,o=0,s=e.split(",");for(const e of s)if(r>0||"{"==e[0]){n.push(e);let s=e.split("");r=s.reduce(((e,t)=>"{"==t?++e:"}"==t?--e:e),r),o=s.reduce(((e,t)=>['"',"'"].includes(t)?++e:e),o),0==r&&"}"==e[e.length-1]&&(t.push(n.join(",")),n=[])}else t.push(e);return 0==r&&o%2==0?t.concat(n).map((e=>""===e||f(e))):[e]}function u(e,t={},n=!0){let r=t[typeof e];return r?r(e):n?JSON.stringify(e,((e,n)=>u(n,t,!1))):e}function l(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}function f(e){try{return JSON.parse(e.replace(/^["'](.*)["']$/,"$1"))}catch{return e}}function h(e,t=!1){let n=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?y(n):n}function y(e,t=!1){let n=[...new Set(e)];return t&&(e=n),n}var d={getArray:h,getUniqValues:y,swapValues:function(e,...t){return t.forEach((([t,n])=>{e[t]=e.splice(n,1,e[t])[0]})),e},excludeValues:function(e,t,n=!1){let r=h(t),o=e.filter((e=>!r.includes(e)));return n&&(e=o),o},sortArrayStr:function(e,t=!1){let n=e.sort(((e,t)=>e.localeCompare(t)));return t&&(e=n),n},shuffleRandom:function(e,t=Math.random()){const n=o(t);for(let t=e.length-1;t>0;t--){const r=n({max:t+1});[e[t],e[r]]=[e[r],e[t]]}return e},isSubArray:function(e,t,n=!1){return(n?e.length==t.length:e.length<=t.length)&&e.every((e=>t.includes(e)))},prevValueCycle:function(e,t){return e[t>0?t-1:e.length-1]},nextValueCycle:function(e,t){return e[t<e.length-1?t+1:0]}};function m(e,t=null){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(!t||t in e)}function g(e,t,n=!1){let r=n?e:M(e);return h(t).forEach((e=>b(r,e,null,{cbAction:(e,t)=>delete e[t]}))),r}function p(e,...t){let n=t.map((e=>e.split("."))),r=n.map((t=>t.reduce(((e,t)=>m(e,t)?e[t]:void 0),e)));return 1==n.length?r[0]:r}function b(e,t,n,r={}){let o=!1;const s=r.onlyExist??!0,a=r.cbAction??(()=>{});let i=t.split(".");if(i.length>1)if(s){const t=i.pop();let r=p(e,i.join("."));m(r,t)&&(r[t]=n,o=a(r,t)??!0)}else{let t=e;i.forEach(((e,r)=>{e in t||(r<i.length-1?(t[e]={},t=t[e]):t[e]=n)}))}else s&&!(t in e)||(e[t]=n,o=a(e,t)??!0);return o}function x(e,t,n=!1,r=!1){return L(e,t,n,r)}function M(e){return JSON.parse(JSON.stringify(e))}function S(e){const t=Object.keys(e);if(t.length>0&&t.every((e=>!Number.isNaN(Number(e))))){let n=[];return t.forEach((t=>n[t]=e[t])),n}return e}var T={isObjectJs:m,excludeKeys:g,getValue:p,setValue:b,setProperties:function(e,t,n=!0){x(t,((t,r,o)=>{const s=Array.isArray(t);if(s||null===t||"object"!=typeof t){const a=""!==o?o+"."+r:r,i=p(e,a);(!n||typeof i==typeof t&&Array.isArray(i)===s)&&b(e,a,t)}}),!0)},traverse:x,merge:function e(...t){return t.reduce(((t,n)=>t=m(n)&&m(t)&&Object.keys(t).length>0?Object.keys(n).reduce(((r,o)=>null!=n[o]?(r[o]=e(t[o],n[o]),r):r),{...t}):null==n?t:n),{})},clone:M,tryConvertToArray:S,getArrayTransferable:function(e){const t=["ArrayBuffer","MessagePort","ReadableStream","WritableStream","TransformStream","ImageBitmap","AudioData","VideoFrame","OffscreenCanvas","RTCDataChannel"];let n=[];return x(e,(e=>{t.some((t=>e.constructor.name===t))&&n.push(e)}),!0,!0),n},getHash:function(e,n=null,r=0){return t(JSON.stringify(g(e,n)),r)}};function L(e,t,n,r,o=[]){const s="__TackleEnumAlreadyProcessed__",a=Object.keys(e);return Object.fromEntries(a.map((a=>{let i=e[a],c=t(i,a,o.join("."))??i;if(r&&Array.isArray(i)||n&&m(i)){if(!i[s]){Object.defineProperty(i,s,{value:!0,writable:!1,configurable:!0});let e=L(i,t,n,r,o.concat(a));c=Array.isArray(i)?S(e):e}delete i[s]}return[a,c]})))}var w={decoMemoize:function(e,t=globalThis){let n=new Map;return function(){let r,o=[].join.call(arguments);return n.has(o)?r=n.get(o):(r=e.apply(t,arguments),n.set(o,r)),r}}};const P=Math.PI/2,D=Math.PI/4,v=2*Math.PI,E=Math.PI/180,j=180/Math.PI;function A(e,t){return e.x*t.x+e.y*t.y}function k(e,t){return e.x*t.y-e.y*t.x}function C(e,t){return{x:e.x-t.x,y:e.y-t.y}}function R(e){const{x:t,y:n}=e,r=1/(Math.sqrt(t*t+n*n)||1);return{x:t*r,y:n*r}}function U(e,t,n=.1){const r=C(t,e);return Math.abs(r.x)<n&&Math.abs(r.y)<n}function O(e,t,n=.1){return t.some((t=>U(e,t,n)))}function N(e,t){const n=C(t,e);return Math.sqrt(n.x**2+n.y**2)}function I(e,t){const n=C(t,e);return Math.abs(n.x)+Math.abs(n.y)}function F(e,t,n){return I(n,e)<I(n,t)}function B(e,t,n,r=!1){const o=((t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y))/2;return r?o:Math.abs(o)}function q(e,t,n,r=1.2){let o=!1;const s=C(t,e),a=s.x**2+s.y**2;if(0!==a){const i=((n.x-e.x)*s.x+(n.y-e.y)*s.y)/a;if(i<0)o=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)<=r;else if(i>1)o=Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2)<=r;else{const t=((e.y-n.y)*s.x-(e.x-n.x)*s.y)/a;o=Math.abs(t)*Math.sqrt(a)<=r}}return o}function J(e,t){let n=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const s=t[r],a=t[o];s.y>e.y!=a.y>e.y&&e.x<(a.x-s.x)*(e.y-s.y)/(a.y-s.y)+s.x&&(n=!n)}return n}function V(e,t,n,r){let o=null;if(e&&t&&n&&r){const s=C(e,t),a=C(r,n),i=k(s,a);if(0!==i){const e=C(r,t);o={Ua:k(e,a)/i,Ub:k(s,e)/i}}}return o}function $(e){return e&&e.Ua>=0&&e.Ua<=1&&e.Ub>=0&&e.Ub<=1}function _(e,t,n){return{x:t.x*e.Ua+n.x*(1-e.Ua),y:t.y*e.Ua+n.y*(1-e.Ua)}}function G(e,t,n,r=(e=>{})){let o=!0;const[s,a]=e;return O(s,t,n)?r(!0):O(a,t,n)?r(!1):o=!1,o}function H(e,t){return{first:e[t[0]],last:e[t[t.length-1]]}}var z={HALF_PI:P,QUART_PI:D,DOUBLE_PI:v,angleDegToRad:function(e=0){return Number(e)*E},angleRadToDeg:function(e=0){return Number(e)*j},roundFloat:function(e,t=3){return Number(e.toFixed(t))},dotProduct2D:A,crossProduct2D:k,delta2D:C,midPoint2D:function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},normalize2D:R,normal2D:function(e,t){return R({x:e.y-t.y,y:t.x-e.x})},angleClockwise2D:function(e,t,n,r=!1){const o=R(C(e,t)),s=R(C(n,t));let a=Math.acos(A(o,s));return k(o,s)<0&&(a*=-1),!r&&a<0&&(a+=v),a},isEqualCoords2D:U,isSomeEqualCoords2D:O,isEqualLinesSegments2D:function(e,t,n,r,o=.1){return U(e,n,o)&&U(t,r,o)||U(t,n,o)&&U(e,r,o)},dist2D:N,distManhattan2D:I,isNearerFirstPt2D:F,areaTriangle2D:B,areaPolygon2D:function(e,t=!1){let n=0;if(e.length>3){const r=e.reduce(((t,n,r)=>t+k(n,e[(r+1)%e.length])),0)/2;n=t?r:Math.abs(r)}else 3===e.length&&(n=B(e[0],e[1],e[2],t));return n},centroidPolygon2D:function(e){let t=0;const n=e.reduce(((n,r,o)=>{const s=e[(o+1)%e.length],a=k(r,s);return t+=a,{x:n.x+(r.x+s.x)*a,y:n.y+(r.y+s.y)*a}}),{x:0,y:0}),r=3*t;return{x:n.x/r,y:n.y/r}},pointOnLineByLen2D:function(e,t,n){const r=C(t,e),o=n/(N(e,t)||1);return{x:e.x+r.x*o,y:e.y+r.y*o}},projectPointToStraightLine2D:function(e,t,n){const r=C(t,e),o=A(C(n,e),r)/A(r,r);return{x:e.x+r.x*o,y:e.y+r.y*o}},sidePointRelativeStraightLine2D:function(e,t,n){const r=k(C(t,e),C(n,e));return Math.sign(r)},isPointBelongStraightLine2D:function(e,t,n,r=1.2){const o=C(t,e),s=k(o,C(n,e)),a=Math.sqrt(o.x**2+o.y**2);return Math.abs(s/a)<=r/2},isPointBelongLineSegment2D:q,isSomePointBelongLineSegment2D:function(e,t,n,r=1.2){return n.some((n=>q(e,t,n,r)))},isEveryPointBelongLineSegment2D:function(e,t,n,r=1.2){return n.every((n=>q(e,t,n,r)))},isPointInsidePolygon2D:J,isSomePointInsidePolygon2D:function(e,t){return e.some((e=>J(e,t)))},isEveryPointInsidePolygon2D:function(e,t){return e.every((e=>J(e,t)))},isParallelStraightLines2D:function(e,t,n,r,o=.1){const s=k(R(C(t,e)),R(C(r,n)));return Math.abs(s)<=Math.sin(P*o)},crossStraightLines2D:function(e,t,n,r){const o=V(e,t,n,r);if(o)return _(o,e,t)},crossLinesSegments2D:function(e,t,n,r){const o=V(e,t,n,r);if($(o))return _(o,e,t)},isCrossLinesSegments2D:function(e,t,n,r){return!0===$(V(e,t,n,r))},chainsLinesSegments2D:function(e,t=!1,n=.1){let r=[];return e.forEach(((t,o)=>{r.some((r=>r.some(((s,a)=>G(t,e[s],n,(e=>{r.splice(a+(e?0:1),0,o)}))))))||r.push([o])})),r.length>1&&(r=function(e,t,n){const r=e.filter(((r,o)=>{let s=!1;const a=H(t,r);for(let i=o+1;i<e.length;i++){const o=e[i],c=H(t,o);if(s=G(a.first,c.last,n,(()=>o.push(...r)))||G(a.last,c.first,n,(()=>o.unshift(...r)))||G(a.last,c.last,n,(()=>o.push(...r.reverse())))||G(a.first,c.first,n,(()=>o.unshift(...r.reverse()))),s)break}return!s}));return r}(r,e,n)),r.map((r=>{t&&r.forEach(((t,n)=>{const o=n<r.length-1?r[n+1]:r[0],[s,a]=e[o],[i]=e[t];F(a,s,i)&&(e[o][0]=a,e[o][1]=s)}));const{first:o,last:s}=H(e,r),a=r.length>2&&G(o,s,n);return{inds:r,closed:a}}))}};function W(e,t={},n=null){const r=self.document.createElement(e),o=t.insertFirst??!1,s=t.subElements??[];return n&&(o?n.insertBefore(r,n.firstChild):n.appendChild(r)),Object.entries(t).forEach((e=>{const[t,n]=e,o="string"==typeof n,s="object"==typeof n;switch(t){case"attributes":s&&Object.entries(n).forEach((([e,t])=>{r.setAttribute(e,t)}));break;case"style":const e=s?Object.entries(n).reduce(((e,[t,n])=>e+`;${t}:${n}`),""):o?`;${n}`:"";r.style.cssText=(r.style.cssText??"")+e;break;case"class":h(n).forEach((e=>r.classList.add(e)));break;case"properties":s&&Object.entries(n).forEach((([e,t])=>{e in r&&(r[e]=t)}));break;case"children":h(n).forEach((e=>r.appendChild(e)))}})),s.forEach((e=>{const t=e.tagName;delete e.tagName,W(t,e,r)})),r}var Q={createHTMLElement:W,applyClasses:function(e,t){const n=h(t.set),r=h(t.unset),o=h(t.toggle);document.querySelectorAll(e).forEach((e=>{n.forEach((t=>e.classList.add(t))),r.forEach((t=>e.classList.remove(t))),o.forEach((t=>e.classList.toggle(t)))}))},setDivResizer:function(e,t){const n=W("iframe",{style:{position:"relative",width:"100%",height:"100%","z-index":-1e4},attributes:{frameborder:"no"}},e).contentWindow;let r={width:null,height:null};n.addEventListener("resize",(()=>{const{width:n,height:o}=getComputedStyle(e);r.width===n&&r.height===o||(t({width:n,height:o}),r={width:n,height:o})})),n.dispatchEvent(new Event("resize"))},interceptErrors:function(e,t=!0){window.addEventListener("error",(n=>{t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(n=>{t&&n.preventDefault(),e(n.reason??"Unknown reason rejection")}))},onDocumentComplete:function(e=(()=>{})){return new Promise((t=>{const n=()=>{e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&n()})):n()}))},httpRequest:function(e,t={}){const n={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,postSendType:"STRING",cbLoad:(e,t)=>{},cbError:(e,t,n)=>{},cbFinal:(e,t,n)=>{},cbProgress:(e,t,n)=>{},...t},r="GET"===n.method,o="POST"===n.method;let a,i=r||o&&n.addPostQString&&"RAW"!==n.postSendType;r&&n.setGetAsFolder&&(e+=s(self.location.href,t.params).searchParams.toString(),i=!1);try{a=new URL(e)}catch{const t=new URL(self.location.href).origin;a=new URL(e,t)}return i&&s(a,t.params),n.useCache||a.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const r=new XMLHttpRequest;r.open(n.method,a,!0),r.responseType=n.responseType,r.timeout=n.timeout;for(let e in n.headers)r.setRequestHeader(e,n.headers[e]);if(r.onloadend=()=>{200!==r.status||"arraybuffer"===n.responseType&&0===r.response.byteLength?(n.cbError(r.status,r.response,n.id),n.useReject?t(r.status):e(null)):(n.cbLoad(r.response,n.id),e(r.response)),n.cbFinal(r.status,r.response,n.id)},r.onprogress=e=>{n.cbProgress(e.loaded,e.total,n.id)},o)switch(n.postSendType){case"RAW":r.send(n.params);break;case"STRING":r.send(K(n.params));break;case"FORM":const e=new FormData;for(const t in n.params)e.append(t,n.params[t]);r.send(e)}else r.send()}))},saveValAsJson:function(e,t){const n=new Blob([K(t,"\t")],{type:"text/json"}),r=URL.createObjectURL(n);setTimeout((()=>URL.revokeObjectURL(r)),1e4),W("a",{properties:{type:"text/json",download:e,href:r}}).click()}};function K(e,t=null){return JSON.stringify(e,((e,t)=>t instanceof Map?Object.fromEntries(t.entries()):t instanceof Set?[...t]:t),t)}var X={},Y={TkArray:d,TkString:n,TkObject:T,TkFunction:w,TkMath:z,TkService:a,TkBrowser:Q,TkNode:X};e.TkArray=d,e.TkBrowser=Q,e.TkFunction=w,e.TkMath=z,e.TkNode=X,e.TkObject=T,e.TkService=a,e.TkString=n,e.default=Y,Object.defineProperty(e,"__esModule",{value:!0})}));
