/* @hrimthurs/tackle 1.26.0 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Tackle={})}(this,(function(e){"use strict";function t(e,t=!1){let r=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?n(r):r}function n(e,t=!1){let n=[...new Set(e)];return t&&(e=n),n}var r={getArray:t,getUniqValues:n,swapValues:function(e,...t){return t.forEach((([t,n])=>{e[t]=e.splice(n,1,e[t])[0]})),e},excludeValues:function(e,n,r=!1){let o=t(n),s=e.filter((e=>!o.includes(e)));return r&&(e=s),s},sortArrayStr:function(e,t=!1){let n=e.sort(((e,t)=>e.localeCompare(t)));return t&&(e=n),n},isSubArray:function(e,t,n=!1){return(n?e.length==t.length:e.length<=t.length)&&e.every((e=>t.includes(e)))},prevValueCycle:function(e,t){return e[t>0?t-1:e.length-1]},nextValueCycle:function(e,t){return e[t<e.length-1?t+1:0]}};function o(e,t=0){const n={f1:3735928559,f2:2654435761,f3:2246822507},r={f1:1103547991,f2:1597334677,f3:3266489909};let o=n.f1^t,s=r.f1^t;for(let t=0;t<e.length;t++){let i=e.charCodeAt(t);o=Math.imul(o^i,n.f2),s=Math.imul(s^i,r.f2)}o=Math.imul(o^o>>>16,n.f3)^Math.imul(s^s>>>13,r.f3),s=Math.imul(s^s>>>16,n.f3)^Math.imul(o^o>>>13,r.f3);let i=(s>>>0).toString(16)+(o>>>0).toString(16);return"0".repeat(16-i.length)+i}var s={formatNumber:function(e,t,n=0){const r=Math.abs(e),o=e<0?"-":"",s=n?r.toFixed(n):r.toString();let i=t-s.length-o.length;return o+(i<=0?s:Number.isInteger(e)&&!n?"0".repeat(i)+s:s+"0".repeat(i))},getHash:o};function i(e,t=null){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(!t||t in e)}function a(e,n,r=!1){let o=r?e:f(e);return t(n).forEach((e=>u(o,e,null,{cbAction:(e,t)=>delete e[t]}))),o}function c(e,...t){let n=t.map((e=>e.split("."))),r=n.map((t=>t.reduce(((e,t)=>i(e,t)?e[t]:void 0),e)));return 1==n.length?r[0]:r}function u(e,t,n,r={}){let o=!1;const s=r.onlyExist??!0,a=r.cbAction??(()=>{});let u=t.split(".");if(u.length>1)if(s){const t=u.pop();let r=c(e,u.join("."));i(r,t)&&(r[t]=n,o=a(r,t)??!0)}else{let t=e;u.forEach(((e,r)=>{e in t||(r<u.length-1?(t[e]={},t=t[e]):t[e]=n)}))}else s&&!(t in e)||(e[t]=n,o=a(e,t)??!0);return o}function l(e,t,n=!1,r=!1){return d(e,t,n,r)}function f(e){return JSON.parse(JSON.stringify(e))}function h(e){const t=Object.keys(e);if(t.length>0&&t.every((e=>!Number.isNaN(Number(e))))){let n=[];return t.forEach((t=>n[t]=e[t])),n}return e}var y={isObjectJs:i,excludeKeys:a,getValue:c,setValue:u,setProperties:function(e,t,n=!0){l(t,((t,r,o)=>{const s=Array.isArray(t);if(s||null===t||"object"!=typeof t){const i=""!==o?o+"."+r:r,a=c(e,i);(!n||typeof a==typeof t&&Array.isArray(a)===s)&&u(e,i,t)}}),!0)},traverse:l,merge:function e(...t){return t.reduce(((t,n)=>t=i(n)&&i(t)&&Object.keys(t).length>0?Object.keys(n).reduce(((r,o)=>null!=n[o]?(r[o]=e(t[o],n[o]),r):r),{...t}):null==n?t:n),{})},clone:f,tryConvertToArray:h,getArrayTransferable:function(e){const t=["ArrayBuffer","MessagePort","ReadableStream","WritableStream","TransformStream","ImageBitmap","AudioData","VideoFrame","OffscreenCanvas","RTCDataChannel"];let n=[];return l(e,(e=>{t.some((t=>e.constructor.name===t))&&n.push(e)}),!0,!0),n},getHash:function(e,t=null,n=0){return o(JSON.stringify(a(e,t)),n)}};function d(e,t,n,r,o=[]){const s="__TackleEnumAlreadyProcessed__",a=Object.keys(e);return Object.fromEntries(a.map((a=>{let c=e[a],u=t(c,a,o.join("."))??c;if(r&&Array.isArray(c)||n&&i(c)){if(!c[s]){Object.defineProperty(c,s,{value:!0,writable:!1,configurable:!0});let e=d(c,t,n,r,o.concat(a));u=Array.isArray(c)?h(e):e}delete c[s]}return[a,u]})))}var m={decoMemoize:function(e,t=globalThis){let n=new Map;return function(){let r,o=[].join.call(arguments);return n.has(o)?r=n.get(o):(r=e.apply(t,arguments),n.set(o,r)),r}}};const g=Math.PI/2,p=Math.PI/4,b=2*Math.PI,x=Math.PI/180,L=180/Math.PI;function M(e,t){return e.x*t.x+e.y*t.y}function P(e,t){return e.x*t.y-e.y*t.x}function T(e,t){return{x:e.x-t.x,y:e.y-t.y}}function S(e){const{x:t,y:n}=e,r=1/(Math.sqrt(t*t+n*n)||1);return{x:t*r,y:n*r}}function w(e,t,n=.1){const r=T(t,e);return Math.abs(r.x)<n&&Math.abs(r.y)<n}function v(e,t){const n=T(t,e);return Math.sqrt(n.x**2+n.y**2)}function E(e,t){const n=T(t,e);return Math.abs(n.x)+Math.abs(n.y)}function D(e,t,n){return E(n,e)<E(n,t)}function j(e,t,n,r=1.2){let o=!1;const s=T(t,e),i=s.x**2+s.y**2;if(0!==i){const a=((n.x-e.x)*s.x+(n.y-e.y)*s.y)/i;if(a<0)o=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)<=r;else if(a>1)o=Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2)<=r;else{const t=((e.y-n.y)*s.x-(e.x-n.x)*s.y)/i;o=Math.abs(t)*Math.sqrt(i)<=r}}return o}function A(e,t){let n=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const s=t[r],i=t[o];s.y>e.y!=i.y>e.y&&e.x<(i.x-s.x)*(e.y-s.y)/(i.y-s.y)+s.x&&(n=!n)}return n}function k(e,t,n,r){let o=null;if(e&&t&&n&&r){const s=T(e,t),i=T(r,n),a=P(s,i);if(0!==a){const e=T(r,t);o={Ua:P(e,i)/a,Ub:P(s,e)/a}}}return o}function O(e){return e&&e.Ua>=0&&e.Ua<=1&&e.Ub>=0&&e.Ub<=1}function U(e,t,n){return{x:t.x*e.Ua+n.x*(1-e.Ua),y:t.y*e.Ua+n.y*(1-e.Ua)}}function C(e,t,n,r=(e=>{})){let o=!0;const[s,i]=e,[a,c]=t;return w(c,s,n)||w(a,s,n)?r(!0):w(a,i,n)||w(c,i,n)?r(!1):o=!1,o}function R(e,t){return{first:e[t[0]],last:e[t[t.length-1]]}}var N={HALF_PI:g,QUART_PI:p,DOUBLE_PI:b,angleDegToRad:function(e=0){return Number(e)*x},angleRadToDeg:function(e=0){return Number(e)*L},roundFloat:function(e,t=3){return Number(e.toFixed(t))},dotProduct2D:M,crossProduct2D:P,delta2D:T,midPoint2D:function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},normalize2D:S,angleClockwise2D:function(e,t,n){const r=S(T(e,t)),o=S(T(n,t));let s=Math.acos(M(r,o));return P(r,o)<0&&(s*=-1),s<0&&(s+=b),s},isEqualCoords2D:w,dist2D:v,distManhattan2D:E,isNearerFirstPt2D:D,areaPolygon2D:function(e,t=!1){const n=e.reduce(((t,n,r)=>t+P(n,e[(r+1)%e.length])),0);return t?n:Math.abs(n)},centroidPolygon2D:function(e){let t=0;const n=e.reduce(((n,r,o)=>{const s=e[(o+1)%e.length],i=P(r,s);return t+=i,{x:n.x+(r.x+s.x)*i,y:n.y+(r.y+s.y)*i}}),{x:0,y:0}),r=3*t;return{x:n.x/r,y:n.y/r}},pointOnLineByLen2D:function(e,t,n){const r=T(t,e),o=n/(v(e,t)||1);return{x:e.x+r.x*o,y:e.y+r.y*o}},projectPointToStraightLine2D:function(e,t,n){const r=T(t,e),o=M(T(n,e),r)/M(r,r);return{x:e.x+r.x*o,y:e.y+r.y*o}},sidePointRelativeStraightLine2D:function(e,t,n){const r=P(T(t,e),T(n,e));return Math.sign(r)},isPointBelongStraightLine2D:function(e,t,n,r=1.2){const o=T(t,e),s=P(o,T(n,e)),i=Math.sqrt(o.x**2+o.y**2);return Math.abs(s/i)<=r/2},isPointBelongLineSegment2D:j,isSomePointBelongLineSegment2D:function(e,t,n,r=1.2){return n.some((n=>j(e,t,n,r)))},isEveryPointBelongLineSegment2D:function(e,t,n,r=1.2){return n.every((n=>j(e,t,n,r)))},isPointInsidePolygon2D:A,isSomePointInsidePolygon2D:function(e,t){return e.some((e=>A(e,t)))},isEveryPointInsidePolygon2D:function(e,t){return e.every((e=>A(e,t)))},isParallelStraightLines2D:function(e,t,n,r,o=.1){const s=P(S(T(t,e)),S(T(r,n)));return Math.abs(s)<=Math.sin(g*o)},crossStraightLines2D:function(e,t,n,r){const o=k(e,t,n,r);if(o)return U(o,e,t)},crossLinesSegments2D:function(e,t,n,r){const o=k(e,t,n,r);if(O(o))return U(o,e,t)},isCrossLinesSegments2D:function(e,t,n,r){return!0===O(k(e,t,n,r))},chainsLinesSegments2D:function(e,t=!1,n=.1){let r=[];return e.forEach(((t,o)=>{r.some((r=>r.some(((s,i)=>C(t,e[s],n,(e=>{r.splice(i+(e?0:1),0,o)}))))))||r.push([o])})),r.length>1&&(r=function(e,t,n){const r=e.filter(((r,o)=>{let s=!1;const i=R(t,r);for(let a=o+1;a<e.length;a++){const o=e[a],c=R(t,o);if(s=C(i.first,c.last,n,(()=>o.push(...r)))||C(i.last,c.first,n,(()=>o.unshift(...r)))||C(i.last,c.last,n,(()=>o.push(...r.reverse())))||C(i.first,c.first,n,(()=>o.unshift(...r.reverse()))),s)break}return!s}));return r}(r,e,n)),r.map((r=>{t&&r.forEach(((t,n)=>{const o=n<r.length-1?r[n+1]:r[0],[s,i]=e[o],[a]=e[t];D(i,s,a)&&(e[o][0]=i,e[o][1]=s)}));const{first:o,last:s}=R(e,r),i=r.length>2&&C(o,s,n);return{inds:r,closed:i}}))}};function I(e,t,n=!1){let r=V(e,{number:e=>Number(e.toFixed(t))});return n?r:JSON.parse(r)}function F(e,t={},n=!1){let r="string"==typeof e?$(e):e;if(r)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>V(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${V(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):V(o)}r.searchParams.set(e,n?encodeURIComponent(o):o)}}return r}var q={bytesToKb:function(e,t=2){return I(e/1024,t)},bytesToMb:function(e,t=2){return I(e/1048576,t)},trimFloat:I,randomLCG:function(e=1,t=null){const n=2147483647,r=1e6,o=t?.min??0,s=(t?.max??r)-o+1;let i=e%n;return function(e=null){if(i=48271*i%n,e){const t=e?.min??0;return i%((e?.max??r)-t+1)+t}{const e=i%s+o;return t?e:e/r}}},getParamsURL:function(e=null,t={}){const n={keysLowerCase:!1,valsLowerCase:!1,...t};let r={},o=e instanceof URL?e:$(e);if(o)for(const e of o.searchParams.keys()){let t=o.searchParams.get(e).replace(/^["'](.*)["']$/,"$1"),s=J(n.valsLowerCase?t.toLowerCase():t),i=s.reduce(((e,t)=>{if("string"==typeof t){let n=t.split(":"),[r,...o]=n,s=o.length>1?o.join(":"):o[0];void 0!==s&&(e[r]=_(s))}return e}),{}),a=Object.keys(i).length!=s.length?s.length>1?s:s[0]:i;r[n.keysLowerCase?e.toLowerCase():e]=a}return r},setParamsURL:F,generateHashUID:function(e=""){const t=10+Math.trunc(10*Math.random()),n=new Array(t).fill(0).map((()=>Math.random())).join();return o(e+Date.now()+n,Math.random())},generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(B[255&e]+B[e>>8&255]+B[e>>16&255]+B[e>>24&255]+"-"+B[255&t]+B[t>>8&255]+"-"+B[t>>16&15|64]+B[t>>24&255]+"-"+B[63&n|128]+B[n>>8&255]+"-"+B[n>>16&255]+B[n>>24&255]+B[255&r]+B[r>>8&255]+B[r>>16&255]+B[r>>24&255]).toLowerCase()},promiseTimeout:function(e,t={}){return new Promise((async(n,r)=>{const o=setTimeout((()=>{t.timeoutReject?r(new Error("timeout")):n()}),e);if(t?.cbCreate(n,o),t.func)try{n(await t.func(...t.args??[]))}catch(e){r(e)}finally{clearTimeout(o)}}))}};const B=new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));function J(e){let t=[],n=[],r=0,o=0,s=e.split(",");for(const e of s)if(r>0||"{"==e[0]){n.push(e);let s=e.split("");r=s.reduce(((e,t)=>"{"==t?++e:"}"==t?--e:e),r),o=s.reduce(((e,t)=>['"',"'"].includes(t)?++e:e),o),0==r&&"}"==e[e.length-1]&&(t.push(n.join(",")),n=[])}else t.push(e);return 0==r&&o%2==0?t.concat(n).map((e=>""===e||_(e))):[e]}function V(e,t={},n=!0){let r=t[typeof e];return r?r(e):n?JSON.stringify(e,((e,n)=>V(n,t,!1))):e}function $(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}function _(e){try{return JSON.parse(e.replace(/^["'](.*)["']$/,"$1"))}catch{return e}}function H(e,t={},n=null){const r=self.document.createElement(e),o=t.insertFirst??!1,s=t.subElements??[];return Object.entries(t).forEach((e=>{const[t,n]=e,o=Array.isArray(n),s="string"==typeof n,i="object"==typeof n;switch(t){case"attributes":i&&Object.entries(n).forEach((([e,t])=>{r.setAttribute(e,t)}));break;case"style":const e=r.style.cssText??"";i?Object.entries(n).forEach((([t,n])=>{r.style.cssText=e+`;${t}:${n}`})):s&&(r.style.cssText=e+`;${n}`);break;case"class":o?n.forEach((e=>r.classList.add(e))):s&&r.classList.add(n);break;case"properties":i&&Object.entries(n).forEach((([e,t])=>{e in r&&(r[e]=t)}))}})),n&&(o?n.insertBefore(r,n.firstChild):n.appendChild(r)),s.forEach((e=>{const t=e.tagName;delete e.tagName,H(t,e,r)})),r}function z(e){const{width:t,height:n}=getComputedStyle(e);return{width:parseInt(t,10)+1,height:parseInt(n,10)+1}}function G(e,t){document.querySelectorAll(e).forEach((e=>t(e)))}var Q={createHTMLElement:H,getSizeHTMLElement:z,applyClasses:function(e,n){const r=t(n.set),o=t(n.unset),s=t(n.toggle);G(e,(e=>{r.forEach((t=>e.classList.add(t))),o.forEach((t=>e.classList.remove(t))),s.forEach((t=>e.classList.toggle(t)))}))},forEachElement:G,setDivResizer:function(e,t){const n=H("iframe",{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}},e),r=n.contentWindow;let o={width:null,height:null};r.addEventListener("resize",(()=>{const e=z(n);o.width===e.width&&o.height===e.height||(t(e),o=e)})),r.dispatchEvent(new Event("resize"))},interceptErrors:function(e,t=!0){window.addEventListener("error",(n=>{t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(n=>{t&&n.preventDefault(),e(n.reason??"Unknown reason rejection")}))},onDocumentComplete:function(e=(()=>{})){return new Promise((t=>{const n=()=>{e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&n()})):n()}))},httpRequest:function(e,t={}){const n={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,cbLoad:(e,t)=>{},cbError:(e,t)=>{},cbFinal:(e,t,n)=>{},cbProgress:(e,t,n)=>{},...t},r="GET"===n.method,o="POST"===n.method;let s,i=r||o&&n.addPostQString;r&&n.setGetAsFolder&&(e+=F(self.location.href,t.params).searchParams.toString(),i=!1);try{s=new URL(e)}catch{const t=new URL(self.location.href).origin;s=new URL(e,t)}return i&&F(s,t.params),n.useCache||s.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const r=new XMLHttpRequest;r.open(n.method,s,!0),r.responseType=n.responseType,r.timeout=n.timeout;for(let e in n.headers)r.setRequestHeader(e,n.headers[e]);r.onloadend=()=>{200!==r.status||"arraybuffer"===n.responseType&&0===r.response.byteLength?(n.cbError(r.status,n.id),n.useReject?t(r.status):e(null)):(n.cbLoad(r.response,n.id),e(r.response)),n.cbFinal(r.status,r.response,n.id)},r.onprogress=e=>{n.cbProgress(e.loaded,e.total,n.id)};const i=JSON.stringify(o?n.params:{});r.send(i)}))},saveValAsJson:function(e,t){const n=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),r=URL.createObjectURL(n);setTimeout((()=>URL.revokeObjectURL(r)),1e4),H("a",{properties:{type:"text/json",download:e,href:r}}).click()}},K={},W={TkArray:r,TkString:s,TkObject:y,TkFunction:m,TkMath:N,TkService:q,TkBrowser:Q,TkNode:K};e.TkArray=r,e.TkBrowser=Q,e.TkFunction=m,e.TkMath=N,e.TkNode=K,e.TkObject=y,e.TkService=q,e.TkString=s,e.default=W,Object.defineProperty(e,"__esModule",{value:!0})}));
