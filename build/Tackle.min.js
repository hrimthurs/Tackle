/* @hrimthurs/tackle 1.15.4 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Tackle={})}(this,(function(e){"use strict";function t(e,t=!1){let n=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?r(n):n}function r(e,t=!1){let r=[...new Set(e)];return t&&(e=r),r}var n={getArray:t,getUniqValues:r,excludeValues:function(e,r,n=!1){let o=t(r),s=e.filter((e=>!o.includes(e)));return n&&(e=s),s},sortArrayStr:function(e,t=!1){let r=e.sort(((e,t)=>e.localeCompare(t)));return t&&(e=r),r},isSubArray:function(e,t,r=!1){return(r?e.length==t.length:e.length<=t.length)&&e.every((e=>t.includes(e)))}};function o(e,t=0){const r={f1:3735928559,f2:2654435761,f3:2246822507},n={f1:1103547991,f2:1597334677,f3:3266489909};let o=r.f1^t,s=n.f1^t;for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);o=Math.imul(o^a,r.f2),s=Math.imul(s^a,n.f2)}o=Math.imul(o^o>>>16,r.f3)^Math.imul(s^s>>>13,n.f3),s=Math.imul(s^s>>>16,r.f3)^Math.imul(o^o>>>13,n.f3);let a=(s>>>0).toString(16)+(o>>>0).toString(16);return"0".repeat(16-a.length)+a}var s={formatNumber:function(e,t,r=0){const n=Math.abs(e),o=e<0?"-":"",s=r?n.toFixed(r):n.toString();let a=t-s.length-o.length;return o+(a<=0?s:Number.isInteger(e)&&!r?"0".repeat(a)+s:s+"0".repeat(a))},getHash:o};function a(e,t=null){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(!t||t in e)}function i(e,r,n=!1){let o=n?e:f(e);return t(r).forEach((e=>l(o,e,null,{cbAction:(e,t)=>delete e[t]}))),o}function c(e,...t){let r=t.map((e=>e.split("."))),n=r.map((t=>t.reduce(((e,t)=>a(e,t)?e[t]:void 0),e)));return 1==r.length?n[0]:n}function l(e,t,r,n={}){let o=!1;const s=n.onlyExist??!0,i=n.cbAction??(()=>{});let l=t.split(".");if(l.length>1)if(s){const t=l.pop();let n=c(e,l.join("."));a(n,t)&&(n[t]=r,o=i(n,t)??!0)}else{let t=e;l.forEach(((e,n)=>{e in t||(n<l.length-1?(t[e]={},t=t[e]):t[e]=r)}))}else s&&!(t in e)||(e[t]=r,o=i(e,t)??!0);return o}function u(e,t,r=!1,n=!1){return p(e,t,r,n)}function f(e){return JSON.parse(JSON.stringify(e))}function d(e){const t=Object.keys(e);if(t.length>0&&t.every((e=>!Number.isNaN(Number(e))))){let r=[];return t.forEach((t=>r[t]=e[t])),r}return e}var h={isObjectJs:a,excludeKeys:i,getValue:c,setValue:l,setProperties:function(e,t,r=!0){u(t,((t,n,o)=>{const s=Array.isArray(t);if(s||null===t||"object"!=typeof t){const a=""!==o?o+"."+n:n,i=c(e,a);(!r||typeof i==typeof t&&Array.isArray(i)===s)&&l(e,a,t)}}),!0)},traverse:u,merge:function e(...t){return t.reduce(((t,r)=>t=a(r)&&a(t)&&Object.keys(t).length>0?Object.keys(r).reduce(((n,o)=>null!=r[o]?(n[o]=e(t[o],r[o]),n):n),{...t}):null==r?t:r),{})},clone:f,tryConvertToArray:d,getArrayTransferable:function(e){const t=["ArrayBuffer","MessagePort","ReadableStream","WritableStream","TransformStream","ImageBitmap","AudioData","VideoFrame","OffscreenCanvas","RTCDataChannel"];let r=[];return u(e,(e=>{t.some((t=>e.constructor.name===t))&&r.push(e)}),!0,!0),r},getHash:function(e,t=null,r=0){return o(JSON.stringify(i(e,t)),r)}};function p(e,t,r,n,o=[]){const s="__TackleEnumAlreadyProcessed__",i=Object.keys(e);return Object.fromEntries(i.map((i=>{let c=e[i],l=t(c,i,o.join("."))??c;if(n&&Array.isArray(c)||r&&a(c)){if(!c[s]){Object.defineProperty(c,s,{value:!0,writable:!1,configurable:!0});let e=p(c,t,r,n,o.concat(i));l=Array.isArray(c)?d(e):e}delete c[s]}return[i,l]})))}var m={decoMemoize:function(e,t=globalThis){let r=new Map;return function(){let n,o=[].join.call(arguments);return r.has(o)?n=r.get(o):(n=e.apply(t,arguments),r.set(o,n)),n}}};function y(e,t,r=!1){let n=j(e,{number:e=>Number(e.toFixed(t))});return r?n:JSON.parse(n)}function g(e,t={},r=!1){let n="string"==typeof e?A(e):e;if(n)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>j(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${j(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):j(o)}n.searchParams.set(e,r?encodeURIComponent(o):o)}}return n}var b={bytesToKb:function(e,t=2){return y(e/1024,t)},bytesToMb:function(e,t=2){return y(e/1048576,t)},trimFloat:y,getParamsURL:function(e=null,t={}){const r={keysLowerCase:!1,valsLowerCase:!1,...t};let n={},o=e instanceof URL?e:A(e);if(o)for(const e of o.searchParams.keys()){let t=o.searchParams.get(e).replace(/^["'](.*)["']$/,"$1"),s=w(r.valsLowerCase?t.toLowerCase():t),a=s.reduce(((e,t)=>{if("string"==typeof t){let r=t.split(":"),[n,...o]=r,s=o.length>1?o.join(":"):o[0];void 0!==s&&(e[n]=E(s))}return e}),{}),i=Object.keys(a).length!=s.length?s.length>1?s:s[0]:a;n[r.keysLowerCase?e.toLowerCase():e]=i}return n},setParamsURL:g,generateHashUID:function(e=""){const t=10+Math.trunc(10*Math.random()),r=new Array(t).fill(0).map((()=>Math.random())).join();return o(e+Date.now()+r,Math.random())},generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(T[255&e]+T[e>>8&255]+T[e>>16&255]+T[e>>24&255]+"-"+T[255&t]+T[t>>8&255]+"-"+T[t>>16&15|64]+T[t>>24&255]+"-"+T[63&r|128]+T[r>>8&255]+"-"+T[r>>16&255]+T[r>>24&255]+T[255&n]+T[n>>8&255]+T[n>>16&255]+T[n>>24&255]).toLowerCase()},promiseTimeout:function(e,t={}){return new Promise((async(r,n)=>{const o=setTimeout((()=>{t.timeoutReject?n(new Error("timeout")):r()}),e);if(t?.cbCreate(r,o),t.func)try{r(await t.func(...t.args??[]))}catch(e){n(e)}finally{clearTimeout(o)}}))}};const T=new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));function w(e){let t=[],r=[],n=0,o=0,s=e.split(",");for(const e of s)if(n>0||"{"==e[0]){r.push(e);let s=e.split("");n=s.reduce(((e,t)=>"{"==t?++e:"}"==t?--e:e),n),o=s.reduce(((e,t)=>['"',"'"].includes(t)?++e:e),o),0==n&&"}"==e[e.length-1]&&(t.push(r.join(",")),r=[])}else t.push(e);return 0==n&&o%2==0?t.concat(r).map((e=>""===e||E(e))):[e]}function j(e,t={},r=!0){let n=t[typeof e];return n?n(e):r?JSON.stringify(e,((e,r)=>j(r,t,!1))):e}function A(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}function E(e){try{return JSON.parse(e.replace(/^["'](.*)["']$/,"$1"))}catch{return e}}function v(e,t,r={}){const n=self.document.createElement(e),o=r.insertFirst??!1,s=r.subElements??[];return Object.entries(r).forEach((e=>{const[t,r]=e,o=Array.isArray(r),s="string"==typeof r,a="object"==typeof r;switch(t){case"attributes":a&&Object.entries(r).forEach((e=>{n.setAttribute(e[0],e[1])}));break;case"style":const e=n.style.cssText??"";a?Object.entries(r).forEach((t=>{n.style.cssText=e+`;${t[0]}:${t[1]}`})):s&&(n.style.cssText=e+`;${r}`);break;case"class":o?r.forEach((e=>n.classList.add(e))):s&&n.classList.add(r);break;case"properties":a&&Object.entries(r).forEach((e=>{e[0]in n&&(n[e[0]]=e[1])}))}})),o?t.insertBefore(n,t.firstChild):t.appendChild(n),s.forEach((e=>{const t=e.tagName;delete e.tagName,v(t,n,e)})),n}function L(e){const{width:t,height:r}=getComputedStyle(e);return{width:parseInt(t,10)+1,height:parseInt(r,10)+1}}function k(e,t){document.querySelectorAll(e).forEach((e=>t(e)))}var S={createHTMLElement:v,getSizeHTMLElement:L,applyClasses:function(e,r){const n=t(r.set),o=t(r.unset);k(e,(e=>{n.forEach((t=>e.classList.add(t))),o.forEach((t=>e.classList.remove(t)))}))},forEachElement:k,setDivResizer:function(e,t){const r=v("iframe",e,{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}}),n=r.contentWindow;let o={width:null,height:null};n.addEventListener("resize",(()=>{const e=L(r);o.width===e.width&&o.height===e.height||(t(e),o=e)})),n.dispatchEvent(new Event("resize"))},interceptErrors:function(e,t=!0){window.addEventListener("error",(r=>{t&&r.preventDefault(),e(r.message)})),window.addEventListener("unhandledrejection",(r=>{t&&r.preventDefault(),e(r.reason??"Unknown reason rejection")}))},httpRequest:function(e,t={}){const r={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,cbLoad:(e,t)=>{},cbError:(e,t)=>{},cbFinal:(e,t,r)=>{},cbProgress:(e,t,r)=>{},...t},n="GET"===r.method,o="POST"===r.method;let s,a=n||o&&r.addPostQString;n&&r.setGetAsFolder&&(e+=g(self.location.href,t.params).searchParams.toString(),a=!1);try{s=new URL(e)}catch{const t=new URL(self.location.href).origin;s=new URL(e,t)}return a&&g(s,t.params),r.useCache||s.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const n=new XMLHttpRequest;n.open(r.method,s,!0),n.responseType=r.responseType,n.timeout=r.timeout;for(let e in r.headers)n.setRequestHeader(e,r.headers[e]);n.onloadend=()=>{200!==n.status||"arraybuffer"===r.responseType&&0===n.response.byteLength?(r.cbError(n.status,r.id),r.useReject?t(n.status):e(null)):(r.cbLoad(n.response,r.id),e(n.response)),r.cbFinal(n.status,n.response,r.id)},n.onprogress=e=>{r.cbProgress(e.loaded,e.total,r.id)};const a=JSON.stringify(o?r.params:{});n.send(a)}))},saveValAsJson:function(e,t){const r=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),n=URL.createObjectURL(r);setTimeout((()=>URL.revokeObjectURL(n)),1e4),v("a",self.document.body,{properties:{type:"text/json",download:e,href:n}}).click()}},O={},M={TkArray:n,TkString:s,TkObject:h,TkFunction:m,TkService:b,TkBrowser:S,TkNode:O};e.TkArray=n,e.TkBrowser=S,e.TkFunction=m,e.TkNode=O,e.TkObject=h,e.TkService=b,e.TkString=s,e.default=M,Object.defineProperty(e,"__esModule",{value:!0})}));
