/* @hrimthurs/tackle 1.29.1 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Tackle={})}(this,(function(e){"use strict";function t(e,t=!1){let r=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?n(r):r}function n(e,t=!1){let n=[...new Set(e)];return t&&(e=n),n}var r={getArray:t,getUniqValues:n,swapValues:function(e,...t){return t.forEach((([t,n])=>{e[t]=e.splice(n,1,e[t])[0]})),e},excludeValues:function(e,n,r=!1){let o=t(n),s=e.filter((e=>!o.includes(e)));return r&&(e=s),s},sortArrayStr:function(e,t=!1){let n=e.sort(((e,t)=>e.localeCompare(t)));return t&&(e=n),n},isSubArray:function(e,t,n=!1){return(n?e.length==t.length:e.length<=t.length)&&e.every((e=>t.includes(e)))},prevValueCycle:function(e,t){return e[t>0?t-1:e.length-1]},nextValueCycle:function(e,t){return e[t<e.length-1?t+1:0]}};function o(e,t=0){const n={f1:3735928559,f2:2654435761,f3:2246822507},r={f1:1103547991,f2:1597334677,f3:3266489909};let o=n.f1^t,s=r.f1^t;for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);o=Math.imul(o^a,n.f2),s=Math.imul(s^a,r.f2)}o=Math.imul(o^o>>>16,n.f3)^Math.imul(s^s>>>13,r.f3),s=Math.imul(s^s>>>16,n.f3)^Math.imul(o^o>>>13,r.f3);let a=(s>>>0).toString(16)+(o>>>0).toString(16);return"0".repeat(16-a.length)+a}var s={formatNumber:function(e,t,n=0){const r=Math.abs(e),o=e<0?"-":"",s=n?r.toFixed(n):r.toString();let a=t-s.length-o.length;return o+(a<=0?s:Number.isInteger(e)&&!n?"0".repeat(a)+s:s+"0".repeat(a))},getHash:o};function a(e,t=null){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(!t||t in e)}function i(e,n,r=!1){let o=r?e:f(e);return t(n).forEach((e=>u(o,e,null,{cbAction:(e,t)=>delete e[t]}))),o}function c(e,...t){let n=t.map((e=>e.split("."))),r=n.map((t=>t.reduce(((e,t)=>a(e,t)?e[t]:void 0),e)));return 1==n.length?r[0]:r}function u(e,t,n,r={}){let o=!1;const s=r.onlyExist??!0,i=r.cbAction??(()=>{});let u=t.split(".");if(u.length>1)if(s){const t=u.pop();let r=c(e,u.join("."));a(r,t)&&(r[t]=n,o=i(r,t)??!0)}else{let t=e;u.forEach(((e,r)=>{e in t||(r<u.length-1?(t[e]={},t=t[e]):t[e]=n)}))}else s&&!(t in e)||(e[t]=n,o=i(e,t)??!0);return o}function l(e,t,n=!1,r=!1){return d(e,t,n,r)}function f(e){return JSON.parse(JSON.stringify(e))}function h(e){const t=Object.keys(e);if(t.length>0&&t.every((e=>!Number.isNaN(Number(e))))){let n=[];return t.forEach((t=>n[t]=e[t])),n}return e}var y={isObjectJs:a,excludeKeys:i,getValue:c,setValue:u,setProperties:function(e,t,n=!0){l(t,((t,r,o)=>{const s=Array.isArray(t);if(s||null===t||"object"!=typeof t){const a=""!==o?o+"."+r:r,i=c(e,a);(!n||typeof i==typeof t&&Array.isArray(i)===s)&&u(e,a,t)}}),!0)},traverse:l,merge:function e(...t){return t.reduce(((t,n)=>t=a(n)&&a(t)&&Object.keys(t).length>0?Object.keys(n).reduce(((r,o)=>null!=n[o]?(r[o]=e(t[o],n[o]),r):r),{...t}):null==n?t:n),{})},clone:f,tryConvertToArray:h,getArrayTransferable:function(e){const t=["ArrayBuffer","MessagePort","ReadableStream","WritableStream","TransformStream","ImageBitmap","AudioData","VideoFrame","OffscreenCanvas","RTCDataChannel"];let n=[];return l(e,(e=>{t.some((t=>e.constructor.name===t))&&n.push(e)}),!0,!0),n},getHash:function(e,t=null,n=0){return o(JSON.stringify(i(e,t)),n)}};function d(e,t,n,r,o=[]){const s="__TackleEnumAlreadyProcessed__",i=Object.keys(e);return Object.fromEntries(i.map((i=>{let c=e[i],u=t(c,i,o.join("."))??c;if(r&&Array.isArray(c)||n&&a(c)){if(!c[s]){Object.defineProperty(c,s,{value:!0,writable:!1,configurable:!0});let e=d(c,t,n,r,o.concat(i));u=Array.isArray(c)?h(e):e}delete c[s]}return[i,u]})))}var m={decoMemoize:function(e,t=globalThis){let n=new Map;return function(){let r,o=[].join.call(arguments);return n.has(o)?r=n.get(o):(r=e.apply(t,arguments),n.set(o,r)),r}}};const p=Math.PI/2,g=Math.PI/4,b=2*Math.PI,x=Math.PI/180,M=180/Math.PI;function S(e,t){return e.x*t.x+e.y*t.y}function T(e,t){return e.x*t.y-e.y*t.x}function L(e,t){return{x:e.x-t.x,y:e.y-t.y}}function P(e){const{x:t,y:n}=e,r=1/(Math.sqrt(t*t+n*n)||1);return{x:t*r,y:n*r}}function w(e,t,n=.1){const r=L(t,e);return Math.abs(r.x)<n&&Math.abs(r.y)<n}function v(e,t,n=.1){return t.some((t=>w(e,t,n)))}function D(e,t){const n=L(t,e);return Math.sqrt(n.x**2+n.y**2)}function E(e,t){const n=L(t,e);return Math.abs(n.x)+Math.abs(n.y)}function j(e,t,n){return E(n,e)<E(n,t)}function A(e,t,n,r=1.2){let o=!1;const s=L(t,e),a=s.x**2+s.y**2;if(0!==a){const i=((n.x-e.x)*s.x+(n.y-e.y)*s.y)/a;if(i<0)o=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)<=r;else if(i>1)o=Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2)<=r;else{const t=((e.y-n.y)*s.x-(e.x-n.x)*s.y)/a;o=Math.abs(t)*Math.sqrt(a)<=r}}return o}function k(e,t){let n=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const s=t[r],a=t[o];s.y>e.y!=a.y>e.y&&e.x<(a.x-s.x)*(e.y-s.y)/(a.y-s.y)+s.x&&(n=!n)}return n}function C(e,t,n,r){let o=null;if(e&&t&&n&&r){const s=L(e,t),a=L(r,n),i=T(s,a);if(0!==i){const e=L(r,t);o={Ua:T(e,a)/i,Ub:T(s,e)/i}}}return o}function O(e){return e&&e.Ua>=0&&e.Ua<=1&&e.Ub>=0&&e.Ub<=1}function R(e,t,n){return{x:t.x*e.Ua+n.x*(1-e.Ua),y:t.y*e.Ua+n.y*(1-e.Ua)}}function U(e,t,n,r=(e=>{})){let o=!0;const[s,a]=e;return v(s,t,n)?r(!0):v(a,t,n)?r(!1):o=!1,o}function N(e,t){return{first:e[t[0]],last:e[t[t.length-1]]}}var I={HALF_PI:p,QUART_PI:g,DOUBLE_PI:b,angleDegToRad:function(e=0){return Number(e)*x},angleRadToDeg:function(e=0){return Number(e)*M},roundFloat:function(e,t=3){return Number(e.toFixed(t))},dotProduct2D:S,crossProduct2D:T,delta2D:L,midPoint2D:function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},normalize2D:P,normal2D:function(e,t){return P({x:e.y-t.y,y:t.x-e.x})},angleClockwise2D:function(e,t,n,r=!1){const o=P(L(e,t)),s=P(L(n,t));let a=Math.acos(S(o,s));return T(o,s)<0&&(a*=-1),!r&&a<0&&(a+=b),a},isEqualCoords2D:w,isSomeEqualCoords2D:v,isEqualLinesSegments2D:function(e,t,n,r,o=.1){return w(e,n,o)&&w(t,r,o)||w(t,n,o)&&w(e,r,o)},dist2D:D,distManhattan2D:E,isNearerFirstPt2D:j,areaPolygon2D:function(e,t=!1){const n=e.reduce(((t,n,r)=>t+T(n,e[(r+1)%e.length])),0);return t?n:Math.abs(n)},centroidPolygon2D:function(e){let t=0;const n=e.reduce(((n,r,o)=>{const s=e[(o+1)%e.length],a=T(r,s);return t+=a,{x:n.x+(r.x+s.x)*a,y:n.y+(r.y+s.y)*a}}),{x:0,y:0}),r=3*t;return{x:n.x/r,y:n.y/r}},pointOnLineByLen2D:function(e,t,n){const r=L(t,e),o=n/(D(e,t)||1);return{x:e.x+r.x*o,y:e.y+r.y*o}},projectPointToStraightLine2D:function(e,t,n){const r=L(t,e),o=S(L(n,e),r)/S(r,r);return{x:e.x+r.x*o,y:e.y+r.y*o}},sidePointRelativeStraightLine2D:function(e,t,n){const r=T(L(t,e),L(n,e));return Math.sign(r)},isPointBelongStraightLine2D:function(e,t,n,r=1.2){const o=L(t,e),s=T(o,L(n,e)),a=Math.sqrt(o.x**2+o.y**2);return Math.abs(s/a)<=r/2},isPointBelongLineSegment2D:A,isSomePointBelongLineSegment2D:function(e,t,n,r=1.2){return n.some((n=>A(e,t,n,r)))},isEveryPointBelongLineSegment2D:function(e,t,n,r=1.2){return n.every((n=>A(e,t,n,r)))},isPointInsidePolygon2D:k,isSomePointInsidePolygon2D:function(e,t){return e.some((e=>k(e,t)))},isEveryPointInsidePolygon2D:function(e,t){return e.every((e=>k(e,t)))},isParallelStraightLines2D:function(e,t,n,r,o=.1){const s=T(P(L(t,e)),P(L(r,n)));return Math.abs(s)<=Math.sin(p*o)},crossStraightLines2D:function(e,t,n,r){const o=C(e,t,n,r);if(o)return R(o,e,t)},crossLinesSegments2D:function(e,t,n,r){const o=C(e,t,n,r);if(O(o))return R(o,e,t)},isCrossLinesSegments2D:function(e,t,n,r){return!0===O(C(e,t,n,r))},chainsLinesSegments2D:function(e,t=!1,n=.1){let r=[];return e.forEach(((t,o)=>{r.some((r=>r.some(((s,a)=>U(t,e[s],n,(e=>{r.splice(a+(e?0:1),0,o)}))))))||r.push([o])})),r.length>1&&(r=function(e,t,n){const r=e.filter(((r,o)=>{let s=!1;const a=N(t,r);for(let i=o+1;i<e.length;i++){const o=e[i],c=N(t,o);if(s=U(a.first,c.last,n,(()=>o.push(...r)))||U(a.last,c.first,n,(()=>o.unshift(...r)))||U(a.last,c.last,n,(()=>o.push(...r.reverse())))||U(a.first,c.first,n,(()=>o.unshift(...r.reverse()))),s)break}return!s}));return r}(r,e,n)),r.map((r=>{t&&r.forEach(((t,n)=>{const o=n<r.length-1?r[n+1]:r[0],[s,a]=e[o],[i]=e[t];j(a,s,i)&&(e[o][0]=a,e[o][1]=s)}));const{first:o,last:s}=N(e,r),a=r.length>2&&U(o,s,n);return{inds:r,closed:a}}))}};function F(e,t,n=!1){let r=$(e,{number:e=>Number(e.toFixed(t))});return n?r:JSON.parse(r)}function q(e,t={},n=!1){let r="string"==typeof e?_(e):e;if(r)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>$(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${$(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):$(o)}r.searchParams.set(e,n?encodeURIComponent(o):o)}}return r}var B={bytesToKb:function(e,t=2){return F(e/1024,t)},bytesToMb:function(e,t=2){return F(e/1048576,t)},trimFloat:F,randomLCG:function(e=1,t=null){const n=2147483647,r=1e5,o=t?.min?t.min-1:0,s=(t?.max??r)-o+1;let a=e%n;return function(e=null){if(a=48271*a%n,e){const t=e.min?e.min-1:0,n=(e.max??r)-t+1;return Math.trunc(a%n+t)}{const e=a%s+o;return t?Math.trunc(e):e/r}}},getParamsURL:function(e=null,t={}){const n={keysLowerCase:!1,valsLowerCase:!1,...t};let r={},o=e instanceof URL?e:_(e);if(o)for(const e of o.searchParams.keys()){let t=o.searchParams.get(e).replace(/^["'](.*)["']$/,"$1"),s=V(n.valsLowerCase?t.toLowerCase():t),a=s.reduce(((e,t)=>{if("string"==typeof t){let n=t.split(":"),[r,...o]=n,s=o.length>1?o.join(":"):o[0];void 0!==s&&(e[r]=G(s))}return e}),{}),i=Object.keys(a).length!=s.length?s.length>1?s:s[0]:a;r[n.keysLowerCase?e.toLowerCase():e]=i}return r},setParamsURL:q,generateHashUID:function(e=""){const t=10+Math.trunc(10*Math.random()),n=new Array(t).fill(0).map((()=>Math.random())).join();return o(e+Date.now()+n,Math.random())},generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(J[255&e]+J[e>>8&255]+J[e>>16&255]+J[e>>24&255]+"-"+J[255&t]+J[t>>8&255]+"-"+J[t>>16&15|64]+J[t>>24&255]+"-"+J[63&n|128]+J[n>>8&255]+"-"+J[n>>16&255]+J[n>>24&255]+J[255&r]+J[r>>8&255]+J[r>>16&255]+J[r>>24&255]).toLowerCase()},promiseTimeout:function(e,t={}){return new Promise((async(n,r)=>{const o=setTimeout((()=>{t.timeoutReject?r(new Error("timeout")):n()}),e);if(t?.cbCreate(n,o),t.func)try{n(await t.func(...t.args??[]))}catch(e){r(e)}finally{clearTimeout(o)}}))}};const J=new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));function V(e){let t=[],n=[],r=0,o=0,s=e.split(",");for(const e of s)if(r>0||"{"==e[0]){n.push(e);let s=e.split("");r=s.reduce(((e,t)=>"{"==t?++e:"}"==t?--e:e),r),o=s.reduce(((e,t)=>['"',"'"].includes(t)?++e:e),o),0==r&&"}"==e[e.length-1]&&(t.push(n.join(",")),n=[])}else t.push(e);return 0==r&&o%2==0?t.concat(n).map((e=>""===e||G(e))):[e]}function $(e,t={},n=!0){let r=t[typeof e];return r?r(e):n?JSON.stringify(e,((e,n)=>$(n,t,!1))):e}function _(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}function G(e){try{return JSON.parse(e.replace(/^["'](.*)["']$/,"$1"))}catch{return e}}function H(e,n={},r=null){const o=self.document.createElement(e),s=n.insertFirst??!1,a=n.subElements??[];return r&&(s?r.insertBefore(o,r.firstChild):r.appendChild(o)),Object.entries(n).forEach((e=>{const[n,r]=e,s="string"==typeof r,a="object"==typeof r;switch(n){case"attributes":a&&Object.entries(r).forEach((([e,t])=>{o.setAttribute(e,t)}));break;case"style":const e=a?Object.entries(r).reduce(((e,[t,n])=>e+`;${t}:${n}`),""):s?`;${r}`:"";o.style.cssText=(o.style.cssText??"")+e;break;case"class":t(r).forEach((e=>o.classList.add(e)));break;case"properties":a&&Object.entries(r).forEach((([e,t])=>{e in o&&(o[e]=t)}));break;case"children":t(r).forEach((e=>o.appendChild(e)))}})),a.forEach((e=>{const t=e.tagName;delete e.tagName,H(t,e,o)})),o}var z={createHTMLElement:H,applyClasses:function(e,n){const r=t(n.set),o=t(n.unset),s=t(n.toggle);document.querySelectorAll(e).forEach((e=>{r.forEach((t=>e.classList.add(t))),o.forEach((t=>e.classList.remove(t))),s.forEach((t=>e.classList.toggle(t)))}))},setDivResizer:function(e,t){const n=H("iframe",{style:{position:"relative",width:"100%",height:"100%","z-index":-1e4},attributes:{frameborder:"no"}},e).contentWindow;let r={width:null,height:null};n.addEventListener("resize",(()=>{const{width:n,height:o}=getComputedStyle(e);r.width===n&&r.height===o||(t({width:n,height:o}),r={width:n,height:o})})),n.dispatchEvent(new Event("resize"))},interceptErrors:function(e,t=!0){window.addEventListener("error",(n=>{t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(n=>{t&&n.preventDefault(),e(n.reason??"Unknown reason rejection")}))},onDocumentComplete:function(e=(()=>{})){return new Promise((t=>{const n=()=>{e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&n()})):n()}))},httpRequest:function(e,t={}){const n={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,postSendType:"STRING",cbLoad:(e,t)=>{},cbError:(e,t,n)=>{},cbFinal:(e,t,n)=>{},cbProgress:(e,t,n)=>{},...t},r="GET"===n.method,o="POST"===n.method;let s,a=r||o&&n.addPostQString&&"RAW"!==n.postSendType;r&&n.setGetAsFolder&&(e+=q(self.location.href,t.params).searchParams.toString(),a=!1);try{s=new URL(e)}catch{const t=new URL(self.location.href).origin;s=new URL(e,t)}return a&&q(s,t.params),n.useCache||s.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const r=new XMLHttpRequest;r.open(n.method,s,!0),r.responseType=n.responseType,r.timeout=n.timeout;for(let e in n.headers)r.setRequestHeader(e,n.headers[e]);if(r.onloadend=()=>{200!==r.status||"arraybuffer"===n.responseType&&0===r.response.byteLength?(n.cbError(r.status,r.response,n.id),n.useReject?t(r.status):e(null)):(n.cbLoad(r.response,n.id),e(r.response)),n.cbFinal(r.status,r.response,n.id)},r.onprogress=e=>{n.cbProgress(e.loaded,e.total,n.id)},o)switch(n.postSendType){case"RAW":r.send(n.params);break;case"STRING":r.send(W(n.params));break;case"FORM":const e=new FormData;for(const t in n.params)e.append(t,n.params[t]);r.send(e)}else r.send()}))},saveValAsJson:function(e,t){const n=new Blob([W(t,"\t")],{type:"text/json"}),r=URL.createObjectURL(n);setTimeout((()=>URL.revokeObjectURL(r)),1e4),H("a",{properties:{type:"text/json",download:e,href:r}}).click()}};function W(e,t=null){return JSON.stringify(e,((e,t)=>t instanceof Map?Object.fromEntries(t.entries()):t instanceof Set?[...t]:t),t)}var Q={},K={TkArray:r,TkString:s,TkObject:y,TkFunction:m,TkMath:I,TkService:B,TkBrowser:z,TkNode:Q};e.TkArray=r,e.TkBrowser=z,e.TkFunction=m,e.TkMath=I,e.TkNode=Q,e.TkObject=y,e.TkService=B,e.TkString=s,e.default=K,Object.defineProperty(e,"__esModule",{value:!0})}));
