/* @hrimthurs/tackle 1.18.1 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Tackle={})}(this,(function(e){"use strict";function t(e,t=!1){let r=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?n(r):r}function n(e,t=!1){let n=[...new Set(e)];return t&&(e=n),n}var r={getArray:t,getUniqValues:n,swapValues:function(e,...t){return t.forEach((([t,n])=>{e[t]=e.splice(n,1,e[t])[0]})),e},excludeValues:function(e,n,r=!1){let o=t(n),s=e.filter((e=>!o.includes(e)));return r&&(e=s),s},sortArrayStr:function(e,t=!1){let n=e.sort(((e,t)=>e.localeCompare(t)));return t&&(e=n),n},isSubArray:function(e,t,n=!1){return(n?e.length==t.length:e.length<=t.length)&&e.every((e=>t.includes(e)))}};function o(e,t=0){const n={f1:3735928559,f2:2654435761,f3:2246822507},r={f1:1103547991,f2:1597334677,f3:3266489909};let o=n.f1^t,s=r.f1^t;for(let t=0;t<e.length;t++){let a=e.charCodeAt(t);o=Math.imul(o^a,n.f2),s=Math.imul(s^a,r.f2)}o=Math.imul(o^o>>>16,n.f3)^Math.imul(s^s>>>13,r.f3),s=Math.imul(s^s>>>16,n.f3)^Math.imul(o^o>>>13,r.f3);let a=(s>>>0).toString(16)+(o>>>0).toString(16);return"0".repeat(16-a.length)+a}var s={formatNumber:function(e,t,n=0){const r=Math.abs(e),o=e<0?"-":"",s=n?r.toFixed(n):r.toString();let a=t-s.length-o.length;return o+(a<=0?s:Number.isInteger(e)&&!n?"0".repeat(a)+s:s+"0".repeat(a))},getHash:o};function a(e,t=null){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&(!t||t in e)}function i(e,n,r=!1){let o=r?e:f(e);return t(n).forEach((e=>u(o,e,null,{cbAction:(e,t)=>delete e[t]}))),o}function c(e,...t){let n=t.map((e=>e.split("."))),r=n.map((t=>t.reduce(((e,t)=>a(e,t)?e[t]:void 0),e)));return 1==n.length?r[0]:r}function u(e,t,n,r={}){let o=!1;const s=r.onlyExist??!0,i=r.cbAction??(()=>{});let u=t.split(".");if(u.length>1)if(s){const t=u.pop();let r=c(e,u.join("."));a(r,t)&&(r[t]=n,o=i(r,t)??!0)}else{let t=e;u.forEach(((e,r)=>{e in t||(r<u.length-1?(t[e]={},t=t[e]):t[e]=n)}))}else s&&!(t in e)||(e[t]=n,o=i(e,t)??!0);return o}function l(e,t,n=!1,r=!1){return h(e,t,n,r)}function f(e){return JSON.parse(JSON.stringify(e))}function y(e){const t=Object.keys(e);if(t.length>0&&t.every((e=>!Number.isNaN(Number(e))))){let n=[];return t.forEach((t=>n[t]=e[t])),n}return e}var d={isObjectJs:a,excludeKeys:i,getValue:c,setValue:u,setProperties:function(e,t,n=!0){l(t,((t,r,o)=>{const s=Array.isArray(t);if(s||null===t||"object"!=typeof t){const a=""!==o?o+"."+r:r,i=c(e,a);(!n||typeof i==typeof t&&Array.isArray(i)===s)&&u(e,a,t)}}),!0)},traverse:l,merge:function e(...t){return t.reduce(((t,n)=>t=a(n)&&a(t)&&Object.keys(t).length>0?Object.keys(n).reduce(((r,o)=>null!=n[o]?(r[o]=e(t[o],n[o]),r):r),{...t}):null==n?t:n),{})},clone:f,tryConvertToArray:y,getArrayTransferable:function(e){const t=["ArrayBuffer","MessagePort","ReadableStream","WritableStream","TransformStream","ImageBitmap","AudioData","VideoFrame","OffscreenCanvas","RTCDataChannel"];let n=[];return l(e,(e=>{t.some((t=>e.constructor.name===t))&&n.push(e)}),!0,!0),n},getHash:function(e,t=null,n=0){return o(JSON.stringify(i(e,t)),n)}};function h(e,t,n,r,o=[]){const s="__TackleEnumAlreadyProcessed__",i=Object.keys(e);return Object.fromEntries(i.map((i=>{let c=e[i],u=t(c,i,o.join("."))??c;if(r&&Array.isArray(c)||n&&a(c)){if(!c[s]){Object.defineProperty(c,s,{value:!0,writable:!1,configurable:!0});let e=h(c,t,n,r,o.concat(i));u=Array.isArray(c)?y(e):e}delete c[s]}return[i,u]})))}var m={decoMemoize:function(e,t=globalThis){let n=new Map;return function(){let r,o=[].join.call(arguments);return n.has(o)?r=n.get(o):(r=e.apply(t,arguments),n.set(o,r)),r}}};const p=Math.PI/2,g=Math.PI/4,b=Math.PI/180;function x(e,t){return e.x*t.x+e.y*t.y}function T(e,t){return e.x*t.y-e.y*t.x}function L(e,t){return{x:e.x-t.x,y:e.y-t.y}}function w(e,t){const n=L(t,e);return Math.sqrt(n.x**2+n.y**2)}function S(e,t){const n=L(t,e);return Math.abs(n.x)+Math.abs(n.y)}function M(e,t,n,r=1.2){let o=!1;const s=L(t,e),a=s.x**2+s.y**2;if(0!==a){const i=((n.x-e.x)*s.x+(n.y-e.y)*s.y)/a;if(i<0)o=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2)<=r;else if(i>1)o=Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2)<=r;else{const t=((e.y-n.y)*s.x-(e.x-n.x)*s.y)/a;o=Math.abs(t)*Math.sqrt(a)<=r}}return o}function P(e,t){let n=!1;for(let r=0,o=t.length-1;r<t.length;o=r++){const s=t[r],a=t[o];s.y>e.y!=a.y>e.y&&e.x<(a.x-s.x)*(e.y-s.y)/(a.y-s.y)+s.x&&(n=!n)}return n}function j(e,t,n,r){let o=null;if(e&&t&&n&&r){const s=L(e,t),a=L(r,n),i=T(s,a);if(0!==i){const e=L(r,t);o={Ua:T(e,a)/i,Ub:T(s,e)/i}}}return o}function A(e){return e&&e.Ua>=0&&e.Ua<=1&&e.Ub>=0&&e.Ub<=1}function E(e,t,n){return{x:t.x*e.Ua+n.x*(1-e.Ua),y:t.y*e.Ua+n.y*(1-e.Ua)}}var v={HALF_PI:p,QUART_PI:g,angleDegToRad:function(e=0){return Number(e)*b},roundFloat:function(e,t=3){return Number(e.toFixed(t))},dotProduct2D:x,crossProduct2D:T,delta2D:L,midPoint2D:function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},isEqualCoords2D:function(e,t,n=.1){const r=L(t,e);return Math.abs(r.x)<n&&Math.abs(r.y)<n},dist2D:w,distManhattan2D:S,isNearerFirstPt2D:function(e,t,n){return S(n,e)<S(n,t)},pointOnLineByLen2D:function(e,t,n){const r=L(t,e),o=n/(w(e,t)||1);return{x:e.x+r.x*o,y:e.y+r.y*o}},projectPointToStraightLine2D:function(e,t,n){const r=L(t,e),o=x(L(n,e),r)/x(r,r);return{x:e.x+r.x*o,y:e.y+r.y*o}},isPointBelongStraightLine2D:function(e,t,n,r=1.2){const o=L(t,e),s=T(o,L(n,e)),a=Math.sqrt(o.x**2+o.y**2);return Math.abs(s/a)<=r/2},isPointBelongLineSegment2D:M,isSomePointBelongLineSegment2D:function(e,t,n,r=1.2){return n.some((n=>M(e,t,n,r)))},isEveryPointBelongLineSegment2D:function(e,t,n,r=1.2){return n.every((n=>M(e,t,n,r)))},isPointInsidePolygon2D:P,isSomePointInsidePolygon2D:function(e,t){return e.some((e=>P(e,t)))},isEveryPointInsidePolygon2D:function(e,t){return e.every((e=>P(e,t)))},crossStraightLines2D:function(e,t,n,r){const o=j(e,t,n,r);if(o)return E(o,e,t)},crossLinesSegments2D:function(e,t,n,r){const o=j(e,t,n,r);if(A(o))return E(o,e,t)},isCrossLinesSegments2D:function(e,t,n,r){return!0===A(j(e,t,n,r))}};function k(e,t,n=!1){let r=R(e,{number:e=>Number(e.toFixed(t))});return n?r:JSON.parse(r)}function D(e,t={},n=!1){let r="string"==typeof e?N(e):e;if(r)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>R(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${R(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):R(o)}r.searchParams.set(e,n?encodeURIComponent(o):o)}}return r}var O={bytesToKb:function(e,t=2){return k(e/1024,t)},bytesToMb:function(e,t=2){return k(e/1048576,t)},trimFloat:k,getParamsURL:function(e=null,t={}){const n={keysLowerCase:!1,valsLowerCase:!1,...t};let r={},o=e instanceof URL?e:N(e);if(o)for(const e of o.searchParams.keys()){let t=o.searchParams.get(e).replace(/^["'](.*)["']$/,"$1"),s=C(n.valsLowerCase?t.toLowerCase():t),a=s.reduce(((e,t)=>{if("string"==typeof t){let n=t.split(":"),[r,...o]=n,s=o.length>1?o.join(":"):o[0];void 0!==s&&(e[r]=I(s))}return e}),{}),i=Object.keys(a).length!=s.length?s.length>1?s:s[0]:a;r[n.keysLowerCase?e.toLowerCase():e]=i}return r},setParamsURL:D,generateHashUID:function(e=""){const t=10+Math.trunc(10*Math.random()),n=new Array(t).fill(0).map((()=>Math.random())).join();return o(e+Date.now()+n,Math.random())},generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(U[255&e]+U[e>>8&255]+U[e>>16&255]+U[e>>24&255]+"-"+U[255&t]+U[t>>8&255]+"-"+U[t>>16&15|64]+U[t>>24&255]+"-"+U[63&n|128]+U[n>>8&255]+"-"+U[n>>16&255]+U[n>>24&255]+U[255&r]+U[r>>8&255]+U[r>>16&255]+U[r>>24&255]).toLowerCase()},promiseTimeout:function(e,t={}){return new Promise((async(n,r)=>{const o=setTimeout((()=>{t.timeoutReject?r(new Error("timeout")):n()}),e);if(t?.cbCreate(n,o),t.func)try{n(await t.func(...t.args??[]))}catch(e){r(e)}finally{clearTimeout(o)}}))}};const U=new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));function C(e){let t=[],n=[],r=0,o=0,s=e.split(",");for(const e of s)if(r>0||"{"==e[0]){n.push(e);let s=e.split("");r=s.reduce(((e,t)=>"{"==t?++e:"}"==t?--e:e),r),o=s.reduce(((e,t)=>['"',"'"].includes(t)?++e:e),o),0==r&&"}"==e[e.length-1]&&(t.push(n.join(",")),n=[])}else t.push(e);return 0==r&&o%2==0?t.concat(n).map((e=>""===e||I(e))):[e]}function R(e,t={},n=!0){let r=t[typeof e];return r?r(e):n?JSON.stringify(e,((e,n)=>R(n,t,!1))):e}function N(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}function I(e){try{return JSON.parse(e.replace(/^["'](.*)["']$/,"$1"))}catch{return e}}function F(e,t={},n=null){const r=self.document.createElement(e),o=t.insertFirst??!1,s=t.subElements??[];return Object.entries(t).forEach((e=>{const[t,n]=e,o=Array.isArray(n),s="string"==typeof n,a="object"==typeof n;switch(t){case"attributes":a&&Object.entries(n).forEach((([e,t])=>{r.setAttribute(e,t)}));break;case"style":const e=r.style.cssText??"";a?Object.entries(n).forEach((([t,n])=>{r.style.cssText=e+`;${t}:${n}`})):s&&(r.style.cssText=e+`;${n}`);break;case"class":o?n.forEach((e=>r.classList.add(e))):s&&r.classList.add(n);break;case"properties":a&&Object.entries(n).forEach((([e,t])=>{e in r&&(r[e]=t)}))}})),n&&(o?n.insertBefore(r,n.firstChild):n.appendChild(r)),s.forEach((e=>{const t=e.tagName;delete e.tagName,F(t,e,r)})),r}function q(e){const{width:t,height:n}=getComputedStyle(e);return{width:parseInt(t,10)+1,height:parseInt(n,10)+1}}function B(e,t){document.querySelectorAll(e).forEach((e=>t(e)))}var J={createHTMLElement:F,getSizeHTMLElement:q,applyClasses:function(e,n){const r=t(n.set),o=t(n.unset),s=t(n.toggle);B(e,(e=>{r.forEach((t=>e.classList.add(t))),o.forEach((t=>e.classList.remove(t))),s.forEach((t=>e.classList.toggle(t)))}))},forEachElement:B,setDivResizer:function(e,t){const n=F("iframe",{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}},e),r=n.contentWindow;let o={width:null,height:null};r.addEventListener("resize",(()=>{const e=q(n);o.width===e.width&&o.height===e.height||(t(e),o=e)})),r.dispatchEvent(new Event("resize"))},interceptErrors:function(e,t=!0){window.addEventListener("error",(n=>{t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(n=>{t&&n.preventDefault(),e(n.reason??"Unknown reason rejection")}))},onDocumentComplete:function(e=(()=>{})){return new Promise((t=>{const n=()=>{e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&n()})):n()}))},httpRequest:function(e,t={}){const n={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,cbLoad:(e,t)=>{},cbError:(e,t)=>{},cbFinal:(e,t,n)=>{},cbProgress:(e,t,n)=>{},...t},r="GET"===n.method,o="POST"===n.method;let s,a=r||o&&n.addPostQString;r&&n.setGetAsFolder&&(e+=D(self.location.href,t.params).searchParams.toString(),a=!1);try{s=new URL(e)}catch{const t=new URL(self.location.href).origin;s=new URL(e,t)}return a&&D(s,t.params),n.useCache||s.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const r=new XMLHttpRequest;r.open(n.method,s,!0),r.responseType=n.responseType,r.timeout=n.timeout;for(let e in n.headers)r.setRequestHeader(e,n.headers[e]);r.onloadend=()=>{200!==r.status||"arraybuffer"===n.responseType&&0===r.response.byteLength?(n.cbError(r.status,n.id),n.useReject?t(r.status):e(null)):(n.cbLoad(r.response,n.id),e(r.response)),n.cbFinal(r.status,r.response,n.id)},r.onprogress=e=>{n.cbProgress(e.loaded,e.total,n.id)};const a=JSON.stringify(o?n.params:{});r.send(a)}))},saveValAsJson:function(e,t){const n=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),r=URL.createObjectURL(n);setTimeout((()=>URL.revokeObjectURL(r)),1e4),F("a",{properties:{type:"text/json",download:e,href:r}}).click()}},$={},H={TkArray:r,TkString:s,TkObject:d,TkFunction:m,TkMath:v,TkService:O,TkBrowser:J,TkNode:$};e.TkArray=r,e.TkBrowser=J,e.TkFunction=m,e.TkMath=v,e.TkNode=$,e.TkObject=d,e.TkService=O,e.TkString=s,e.default=H,Object.defineProperty(e,"__esModule",{value:!0})}));
