/* @hrimthurs/tackle 1.18.1 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TkBrowser={})}(this,(function(e){"use strict";function t(e,t={},s=!1){let r="string"==typeof e?function(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}(e):e;if(r)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>n(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${n(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):n(o)}r.searchParams.set(e,s?encodeURIComponent(o):o)}}return r}function n(e,t={},s=!0){let r=t[typeof e];return r?r(e):s?JSON.stringify(e,((e,s)=>n(s,t,!1))):e}function s(e,t=!1){let n=Array.isArray(e)?[...e]:null!=e?[e]:[];return t?function(e,t=!1){let n=[...new Set(e)];t&&(e=n);return n}(n):n}function r(e,t={},n=null){const s=self.document.createElement(e),o=t.insertFirst??!1,a=t.subElements??[];return Object.entries(t).forEach((e=>{const[t,n]=e,r=Array.isArray(n),o="string"==typeof n,a="object"==typeof n;switch(t){case"attributes":a&&Object.entries(n).forEach((([e,t])=>{s.setAttribute(e,t)}));break;case"style":const e=s.style.cssText??"";a?Object.entries(n).forEach((([t,n])=>{s.style.cssText=e+`;${t}:${n}`})):o&&(s.style.cssText=e+`;${n}`);break;case"class":r?n.forEach((e=>s.classList.add(e))):o&&s.classList.add(n);break;case"properties":a&&Object.entries(n).forEach((([e,t])=>{e in s&&(s[e]=t)}))}})),n&&(o?n.insertBefore(s,n.firstChild):n.appendChild(s)),a.forEach((e=>{const t=e.tagName;delete e.tagName,r(t,e,s)})),s}function o(e){const{width:t,height:n}=getComputedStyle(e);return{width:parseInt(t,10)+1,height:parseInt(n,10)+1}}function a(e,t){const n=s(t.set),r=s(t.unset),o=s(t.toggle);i(e,(e=>{n.forEach((t=>e.classList.add(t))),r.forEach((t=>e.classList.remove(t))),o.forEach((t=>e.classList.toggle(t)))}))}function i(e,t){document.querySelectorAll(e).forEach((e=>t(e)))}function c(e,t){const n=r("iframe",{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}},e),s=n.contentWindow;let a={width:null,height:null};s.addEventListener("resize",(()=>{const e=o(n);a.width===e.width&&a.height===e.height||(t(e),a=e)})),s.dispatchEvent(new Event("resize"))}function l(e,t=!0){window.addEventListener("error",(n=>{t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(n=>{t&&n.preventDefault(),e(n.reason??"Unknown reason rejection")}))}function d(e=(()=>{})){return new Promise((t=>{const n=()=>{e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&n()})):n()}))}function u(e,n={}){const s={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,cbLoad:(e,t)=>{},cbError:(e,t)=>{},cbFinal:(e,t,n)=>{},cbProgress:(e,t,n)=>{},...n},r="GET"===s.method,o="POST"===s.method;let a,i=r||o&&s.addPostQString;r&&s.setGetAsFolder&&(e+=t(self.location.href,n.params).searchParams.toString(),i=!1);try{a=new URL(e)}catch{const t=new URL(self.location.href).origin;a=new URL(e,t)}return i&&t(a,n.params),s.useCache||a.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const n=new XMLHttpRequest;n.open(s.method,a,!0),n.responseType=s.responseType,n.timeout=s.timeout;for(let e in s.headers)n.setRequestHeader(e,s.headers[e]);n.onloadend=()=>{200!==n.status||"arraybuffer"===s.responseType&&0===n.response.byteLength?(s.cbError(n.status,s.id),s.useReject?t(n.status):e(null)):(s.cbLoad(n.response,s.id),e(n.response)),s.cbFinal(n.status,n.response,s.id)},n.onprogress=e=>{s.cbProgress(e.loaded,e.total,s.id)};const r=JSON.stringify(o?s.params:{});n.send(r)}))}function f(e,t){const n=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),s=URL.createObjectURL(n);setTimeout((()=>URL.revokeObjectURL(s)),1e4),r("a",{properties:{type:"text/json",download:e,href:s}}).click()}new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));var p={createHTMLElement:r,getSizeHTMLElement:o,applyClasses:a,forEachElement:i,setDivResizer:c,interceptErrors:l,onDocumentComplete:d,httpRequest:u,saveValAsJson:f};e.applyClasses=a,e.createHTMLElement=r,e.default=p,e.forEachElement=i,e.getSizeHTMLElement=o,e.httpRequest=u,e.interceptErrors=l,e.onDocumentComplete=d,e.saveValAsJson=f,e.setDivResizer=c,Object.defineProperty(e,"__esModule",{value:!0})}));
