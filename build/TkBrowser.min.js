/* @hrimthurs/tackle 1.14.5 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TkBrowser={})}(this,(function(e){"use strict";function t(e,t={},r=!1){let n="string"==typeof e?function(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch{}}(e):e;if(n)for(const e in t){let o=t[e];if(void 0!==o){if("object"==typeof o&&null!==o){let e=Array.isArray(o)?o.map((e=>s(e,{string:e=>e}))):Object.entries(o).map((e=>`${e[0]}:${s(e[1],{string:e=>e})}`));o=e.length>0?e.join(","):s(o)}n.searchParams.set(e,r?encodeURIComponent(o):o)}}return n}function s(e,t={},r=!0){let n=t[typeof e];return n?n(e):r?JSON.stringify(e,((e,r)=>s(r,t,!1))):e}function r(e,t,s={}){const n=self.document.createElement(e),o=s.insertFirst??!1,i=s.subElements??[];return Object.entries(s).forEach((e=>{const[t,s]=e,r=Array.isArray(s),o="string"==typeof s,i="object"==typeof s;switch(t){case"attributes":i&&Object.entries(s).forEach((e=>{n.setAttribute(e[0],e[1])}));break;case"style":const e=n.style.cssText??"";i?Object.entries(s).forEach((t=>{n.style.cssText=e+`;${t[0]}:${t[1]}`})):o&&(n.style.cssText=e+`;${s}`);break;case"class":r?s.forEach((e=>n.classList.add(e))):o&&n.classList.add(s);break;case"properties":i&&Object.entries(s).forEach((e=>{e[0]in n&&(n[e[0]]=e[1])}))}})),o?t.insertBefore(n,t.firstChild):t.appendChild(n),i.forEach((e=>{const t=e.tagName;delete e.tagName,r(t,n,e)})),n}function n(e){const{width:t,height:s}=getComputedStyle(e);return{width:parseInt(t,10)+1,height:parseInt(s,10)+1}}function o(e,t){const s=r("iframe",e,{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}}),o=s.contentWindow;let i={width:null,height:null};o.addEventListener("resize",(()=>{const e=n(s);i.width===e.width&&i.height===e.height||(t(e),i=e)})),o.dispatchEvent(new Event("resize"))}function i(e,t=!0){window.addEventListener("error",(s=>{t&&s.preventDefault(),e(s.message)})),window.addEventListener("unhandledrejection",(s=>{t&&s.preventDefault(),e(s.reason??"Unknown reason rejection")}))}function a(e,s={}){const r={method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,delSearchMark:!1,cbLoad:(e,t)=>{},cbError:(e,t)=>{},cbFinal:(e,t,s)=>{},cbProgress:(e,t,s)=>{},...s},n=r.delSearchMark?"/"+t(self.location.href,s.params).searchParams.toString():"";let o;try{o=new URL(e+n)}catch{const t=new URL(self.location.href).origin;o=new URL(e+n,t)}return r.delSearchMark||"GET"!==r.method||t(o,s.params),r.useCache||o.searchParams.set("r",Math.random().toString()),new Promise(((e,t)=>{const s=new XMLHttpRequest;s.open(r.method,o,!0),s.responseType=r.responseType,s.timeout=r.timeout;for(let e in r.headers)s.setRequestHeader(e,r.headers[e]);s.onloadend=()=>{200!==s.status||"arraybuffer"===r.responseType&&0===s.response.byteLength?(r.cbError(s.status,r.id),r.useReject?t(s.status):e(null)):(r.cbLoad(s.response,r.id),e(s.response)),r.cbFinal(s.status,s.response,r.id)},s.onprogress=e=>{r.cbProgress(e.loaded,e.total,r.id)};const n=JSON.stringify("POST"===r.method?r.params:{});s.send(n)}))}function c(e,t){const s=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),n=URL.createObjectURL(s);setTimeout((()=>URL.revokeObjectURL(n)),1e4),r("a",self.document.body,{properties:{type:"text/json",download:e,href:n}}).click()}new Array(256).fill(0).map(((e,t)=>(t<16?"0":"")+t.toString(16)));var l={createHTMLElement:r,getSizeHTMLElement:n,setDivResizer:o,interceptErrors:i,httpRequest:a,saveValAsJson:c};e.createHTMLElement=r,e.default=l,e.getSizeHTMLElement=n,e.httpRequest=a,e.interceptErrors=i,e.saveValAsJson=c,e.setDivResizer=o,Object.defineProperty(e,"__esModule",{value:!0})}));
