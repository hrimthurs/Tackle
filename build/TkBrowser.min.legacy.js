/* @hrimthurs/tackle 1.23.0 https://github.com/hrimthurs/Tackle @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TkBrowser={})}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="string"==typeof e?f(e):e;if(o)for(var i in t){var a=t[i];if(void 0!==a){if("object"===r(a)&&null!==a){var s=Array.isArray(a)?a.map((function(e){return l(e,{string:function(e){return e}})})):Object.entries(a).map((function(e){return"".concat(e[0],":").concat(l(e[1],{string:function(e){return e}}))}));a=s.length>0?s.join(","):l(a)}o.searchParams.set(i,n?encodeURIComponent(a):a)}}return o}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=t[r(e)];return o?o(e):n?JSON.stringify(e,(function(e,n){return l(n,t,!1)})):e}function f(e){try{return new URL(decodeURIComponent(e||self.location.href))}catch(e){}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Array.isArray(e)?a(e):null!=e?[e]:[];return t?p(n):n}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=a(new Set(e));return t&&(e=n),n}function y(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=self.document.createElement(e),c=null!==(t=o.insertFirst)&&void 0!==t&&t,u=null!==(n=o.subElements)&&void 0!==n?n:[];return Object.entries(o).forEach((function(e){var t,n=i(e,2),o=n[0],a=n[1],c=Array.isArray(a),u="string"==typeof a,l="object"===r(a);switch(o){case"attributes":l&&Object.entries(a).forEach((function(e){var t=i(e,2),n=t[0],r=t[1];s.setAttribute(n,r)}));break;case"style":var f=null!==(t=s.style.cssText)&&void 0!==t?t:"";l?Object.entries(a).forEach((function(e){var t=i(e,2),n=t[0],r=t[1];s.style.cssText=f+";".concat(n,":").concat(r)})):u&&(s.style.cssText=f+";".concat(a));break;case"class":c?a.forEach((function(e){return s.classList.add(e)})):u&&s.classList.add(a);break;case"properties":l&&Object.entries(a).forEach((function(e){var t=i(e,2),n=t[0],r=t[1];n in s&&(s[n]=r)}))}})),a&&(c?a.insertBefore(s,a.firstChild):a.appendChild(s)),u.forEach((function(e){var t=e.tagName;delete e.tagName,y(t,e,s)})),s}function h(e){var t=getComputedStyle(e),n=t.width,r=t.height;return{width:parseInt(n,10)+1,height:parseInt(r,10)+1}}function m(e,t){var n=d(t.set),r=d(t.unset),o=d(t.toggle);v(e,(function(e){n.forEach((function(t){return e.classList.add(t)})),r.forEach((function(t){return e.classList.remove(t)})),o.forEach((function(t){return e.classList.toggle(t)}))}))}function v(e,t){document.querySelectorAll(e).forEach((function(e){return t(e)}))}function b(e,t){var n=y("iframe",{style:"position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:-10000",attributes:{frameborder:"no"}},e),r=n.contentWindow,o={width:null,height:null};r.addEventListener("resize",(function(){var e=h(n);o.width===e.width&&o.height===e.height||(t(e),o=e)})),r.dispatchEvent(new Event("resize"))}function g(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];window.addEventListener("error",(function(n){t&&n.preventDefault(),e(n.message)})),window.addEventListener("unhandledrejection",(function(n){var r;t&&n.preventDefault(),e(null!==(r=n.reason)&&void 0!==r?r:"Unknown reason rejection")}))}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise((function(t){var n=function(){e(),t(!0)};"complete"!==document.readyState?document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&n()})):n()}))}function j(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n({method:"GET",responseType:"arraybuffer",params:{},headers:{},id:null,timeout:1e4,useCache:!0,useReject:!1,setGetAsFolder:!1,addPostQString:!1,cbLoad:function(e,t){},cbError:function(e,t){},cbFinal:function(e,t,n){},cbProgress:function(e,t,n){}},r),i="GET"===o.method,a="POST"===o.method,s=i||a&&o.addPostQString;i&&o.setGetAsFolder&&(e+=u(self.location.href,r.params).searchParams.toString(),s=!1);try{t=new URL(e)}catch(n){var c=new URL(self.location.href).origin;t=new URL(e,c)}return s&&u(t,r.params),o.useCache||t.searchParams.set("r",Math.random().toString()),new Promise((function(e,n){var r=new XMLHttpRequest;for(var i in r.open(o.method,t,!0),r.responseType=o.responseType,r.timeout=o.timeout,o.headers)r.setRequestHeader(i,o.headers[i]);r.onloadend=function(){200!==r.status||"arraybuffer"===o.responseType&&0===r.response.byteLength?(o.cbError(r.status,o.id),o.useReject?n(r.status):e(null)):(o.cbLoad(r.response,o.id),e(r.response)),o.cbFinal(r.status,r.response,o.id)},r.onprogress=function(e){o.cbProgress(e.loaded,e.total,o.id)};var s=JSON.stringify(a?o.params:{});r.send(s)}))}function E(e,t){var n=new Blob([JSON.stringify(t,null,"\t")],{type:"text/json"}),r=URL.createObjectURL(n);setTimeout((function(){return URL.revokeObjectURL(r)}),1e4),y("a",{properties:{type:"text/json",download:e,href:r}}).click()}new Array(256).fill(0).map((function(e,t){return(t<16?"0":"")+t.toString(16)}));var O={createHTMLElement:y,getSizeHTMLElement:h,applyClasses:m,forEachElement:v,setDivResizer:b,interceptErrors:g,onDocumentComplete:w,httpRequest:j,saveValAsJson:E};e.applyClasses=m,e.createHTMLElement=y,e.default=O,e.forEachElement=v,e.getSizeHTMLElement=h,e.httpRequest=j,e.interceptErrors=g,e.onDocumentComplete=w,e.saveValAsJson=E,e.setDivResizer=b,Object.defineProperty(e,"__esModule",{value:!0})}));
